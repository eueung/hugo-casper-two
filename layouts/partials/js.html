<script type="text/javascript" src="{{"js/highlight.pack.js" | absURL}}"></script>
<script type="text/javascript" src="{{"js/jquery-3.3.1.min.js" | absURL}}"></script>
<script type="text/javascript" src="{{"js/jquery.fitvids.js" | absURL}}"></script>

<script>hljs.initHighlightingOnLoad();</script>

{{ with .Site.Params.googleAnalytics }}
  <link rel="stylesheet" type="text/css" href="/css/cookieconsent.min.css" />
  <script src="/js/cookieconsent.min.js"></script>
  <script>

    const cookieConsentSettings = {
        "palette": {
            "popup": {
                "background": "#ddd"
            },
            "button": {
                "background": "#75efa4"
            }
        },
        "theme": "classic",
        "position": "bottom-right",
        "type": "opt-in",
        "content": {
            "href": "https://blog.jbrosi.dev/privacy-policy/"
        },
        "onStatusChange": function(status) {
            if (status === "allow") {
                loadGoogleAnalytics()
            } else {
                unloadGoogleAnalytics()
            }
        }
    }

    const openCookieSettings = function () {
        $('.cc-revoke').click()
    }

    const loadGoogleAnalytics = function () {
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.googletagmanager.com/gtag/js?id=G-BMF3T6V40D','ga');
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_TRACKING_ID', { 'anonymize_ip': true });
        gtag('config', 'G-BMF3T6V40D');
    }
    const deleteCookie = function(name) {
        document.cookie = name + '=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;';
    }
    const unloadGoogleAnalytics = function () {
        deleteCookie('_ga')
        deleteCookie('_gat')
        deleteCookie('_gid')
        window.location.reload()
    }

    window.addEventListener("load", function() {
        window.cookieconsent.initialise(cookieConsentSettings);
    })

    if (document.cookie.indexOf('cookieconsent_status=allow') > -1) {
        loadGoogleAnalytics();
    }

    const updateCurrentCookieSettings = () => {
        console.log('updating')
        const isAllow = document.cookie.indexOf('cookieconsent_status=allow') > -1
        const isDeny = document.cookie.indexOf('cookieconsent_status=deny') > -1
        $('.current-cookie-settings').text(isAllow ? 'Cookies allowed' : isDeny ? 'Cookies denied' : 'no option chosen, Cookies denied')
    }
    const updateCurrentCookieSettings_de = () => {
        console.log('updating')
        const isAllow = document.cookie.indexOf('cookieconsent_status=allow') > -1
        const isDeny = document.cookie.indexOf('cookieconsent_status=deny') > -1
        $('.current-cookie-settings').text(isAllow ? 'Cookies erlaubt' : isDeny ? 'Cookies verweigert' : 'keine Option gew√§hlt, Cookies verweigert')
    }
  </script>
{{ end }}

<!-- Load PhotoSwipe js if the load-photoswipe shortcode has been used -->
{{ if ($.Scratch.Get "photoswipeloaded") }}
<script src="/js/load-photoswipe.js"></script>
<script src="/js/photoswipe.min.js"></script>
<script src="/js/photoswipe-ui-default.min.js"></script>
{{ end }}


